<!DOCTYPE html>
<html>

<head>
  <meta charset="windows-1252">
  <meta name="viewport" content="width=device-width">
  <title>Bug bounty Report Template</title>
  <script src="/cdn-cgi/apps/head/tw-E3VJ0w0p5fA3ZAP2bnxi3Vzg.js"></script>
  <link rel="shortcut icon" type="image/png" href>
  <link rel="stylesheet" href="necolas.github.io/normalize.css/8.0.0/normalize.css">
  <style>
    body {
      font-family: sans-serif;
      padding: 30px;
      word-wrap: break-word;
      overflow-wrap: break-word;
    }

    pre {
      white-space: pre-wrap;
      background: #000;
      color: #0c0;
      padding: 15px;
    }

    h1 {
      margin-top: 45px;
      padding-bottom: 10px;
      border-bottom: 1px solid #0c0;
    }

    a {
      color: #fff;
      font-weight: bold;
    }

    a:hover {
      opacity: 0.7;
    }

    .button {
      display: block;
      margin-top: 20px;
      padding: 10px 20px;
      content: "copy";
      background: #0c0;
      color: #000;
      border: none;
      cursor: pointer;
    }

    .back {
      font-weight: bold;
      margin-top: 20px;
      padding: 10px 20px;
      content: "copy";
      background: #0c0;
      color: #000;
      border: none;
      cursor: pointer;
    }

    .back:hover {
      opacity: 0.8;
    }

    .button:after {
      content: "Copy";
      font-weight: bold;
    }

    .button:hover {
      opacity: 0.7;
    }

    article {
      background: #333;
      color: #fff;
      padding: 15px 25px;
    }

    article h1 {
      color: #0c0;
      border-bottom: none;
      padding-bottom: 0;
      margin-bottom: 0;
    }

    small {
      color: #0c0;
    }

    input[type="text"] {
      margin-bottom: 10px;
      padding: 5px 10px;
    }

    .center {
      text-align: center;
      color: #fff;
      background: #000;
      padding: 10px;
    }
  </style>
</head>

<body>
  <article>
    <h1>DOM XSS (DOM-based Cross-Site Scripting)</h1>
    <small>By Rohit Sharma</small>
    <hr>
    <pre><code>DOM XSS (DOM-based Cross-Site Scripting)
    
Summary: DOM XSS (DOM-based Cross-Site Scripting) is a web security vulnerability that occurs when client-side JavaScript code dynamically manipulates the Document Object Model (DOM) based on untrusted data without proper validation or sanitization. By exploiting this vulnerability, attackers can inject and execute malicious scripts in the victim's browser, leading to the theft of sensitive information, session hijacking, or unauthorized actions.

Severity: High

Attack Vector: Remote

Complexity: Medium

Impact: By successfully exploiting DOM XSS, attackers can manipulate the behavior and content of web pages viewed by users, steal user credentials, perform actions on behalf of the user, distribute malware, or deface the website.

Affected IP Address: https://www.example.com/

Port: 443

Steps to Reproduce:

1. Identify the target web application vulnerable to DOM XSS.
2. Analyze client-side JavaScript code and its interaction with the DOM.
3. Look for areas where untrusted data is directly used in manipulating the DOM or executing JavaScript code.
4. Craft a malicious payload, including JavaScript or other scripting code, that can be injected into the vulnerable DOM manipulation point.
5. Inject the crafted payload into the vulnerable DOM manipulation point and observe if the injected script is executed in the victim's browser.

Recommendations:

To mitigate DOM XSS vulnerabilities, consider the following recommendations:
1. Implement proper input validation and sanitization on all user-supplied data used in DOM manipulation.
2. Use context-aware output encoding or escaping when dynamically modifying the DOM with untrusted data.
3. Implement strong Content Security Policy (CSP) to restrict the execution of untrusted scripts and enforce strict source whitelisting.
4. Regularly update and patch web application frameworks, libraries, and dependencies to address any known DOM XSS vulnerabilities.
5. Educate developers about secure coding practices, the risks associated with DOM XSS attacks, and the importance of input validation, output encoding, and context-awareness.

References: 

1. OWASP - DOM-based Cross-Site Scripting (DOM XSS): https://owasp.org/www-community/attacks/DOM_Based_XSS
2. PortSwigger - DOM-based Cross-Site Scripting (DOM XSS): https://portswigger.net/web-security/cross-site-scripting/dom-based

Proof of Concept:

Please refer to the attached screenshot or video for a visual demonstration of a DOM XSS vulnerability.


</code></pre>
    <hr>
    <button id="back" class="back">Back</button>
  </article>
  <script src="cdnjs.cloudflare.com/ajax/libs/clipboard.js/1.7.1/clipboard.min.js"></script>
  <script>
    /* ===========================================
      Create a "copy to clipboard" button on 
      each code block.
    ============================================*/
    var pre = document.getElementsByTagName('pre');
    for (var i = 0; i < pre.length; i++) {
      var button = document.createElement('button');
      button.className = 'button';
      pre[i].appendChild(button);
    }

    var clipboard = new Clipboard('.button', {
      target: function (trigger) { return trigger.previousElementSibling; }
    });

    function showSuccess(elem) { elem.setAttribute('class', 'button'); }
    function sleep(time) {
      return new Promise((resolve) => setTimeout(resolve, time));
    }
    clipboard.on('success', function (e) {
      showSuccess(e.trigger);
      sleep(350).then(() => {
        e.clearSelection();
        e.trigger.setAttribute('class', 'button');
      })
    });

    /* ===========================================
      Allow users to submit usernames and store 
      them in localStorage for future use.
    ============================================*/
    elem = document.getElementsByTagName("pre")[0].children[0];


    document.getElementById("back").addEventListener("click", function () {
      location.href = "index.html";
    });

  </script>
</body>

</html>